<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

  <head>
    <meta charset="UTF-8">
    <title>マイページ</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
  </head>

  <body>
    <div>
      <header th:replace="~{fragments/header::header}"></header>
    </div>

    <div class="sidebar" th:replace="~{fragments/sidebar::sidebar}"></div>

    <div class="mypage-container">
      <div class="user-info-container">
        <div class="message-area">
          <div class="success-message"
               th:if="${successMessage != null}"
               th:text="${successMessage}"></div>
        </div>

        <div class="inner-title">基本情報</div>
        <table class="view-table">
          <tr>
            <th scope="row" class="view-row-th">ログインID</th>
            <td th:text="${basicInfoDto.loginId}"></td>
          </tr>
          <tr>
            <th scope="row" class="view-row-th">ユーザー名</th>
            <td th:text="${basicInfoDto.userName}"></td>
          </tr>
          <tr>
            <th scope="row" class="view-row-th">メールアドレス</th>
            <td th:text="${basicInfoDto.email}"></td>
          </tr>
          <tr>
            <td colspan="2" class="edit-link-td">
              <a class="edit-link" th:href="@{/mypage/edit}">変更する</a>
            </td>
          </tr>
        </table>

        <div class="inner-title">パスワード情報</div>
        <table class="view-table">
          <tr>
            <th scope="row" class="view-row-th">パスワード</th>
            <td>＊＊＊＊＊＊＊＊＊＊</td>
          </tr>
          <tr>
            <td colspan="2" class="edit-link-td">
              <a class="edit-link" th:href="@{/mypage/change_password}">変更する</a>
            </td>
          </tr>
        </table>
      </div>

      <div class="account-delete-container">
        <form id="deleteUserAccount" class="form-group"
              th:action="@{/mypage/delete_account}" method="post">
          <input type="hidden" name="_method" value="delete">
          <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}">
          <div class="button-area">
            <button type="submit"
                    class="delete-account-button">アカウントを削除する</button>
          </div>
        </form>

        <!-- アカウント削除ボタンクリック時に表示するダイアログ -->
        <script th:inline="javascript">
          /*<![CDATA[*/
              const deleteConfirmMessage = /*[[#{delete.account}]]*/;

              document.getElementById("deleteUserAccount")
                  .addEventListener("submit", function(e) {
                  if(!confirm(deleteConfirmMessage)) {
                      e.preventDefault();
                  }
              });
          /*]]>*/
        </script>
      </div>
    </div>
  </body>
</html>